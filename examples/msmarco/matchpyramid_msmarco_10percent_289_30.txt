{
  "inputs": {
    "test": {
      "phase": "EVAL", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_test.txt", 
      "batch_list": 10
    }, 
    "predict": {
      "phase": "PREDICT", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_test.txt", 
      "batch_list": 10
    }, 
    "train": {
      "relation_file": "./data/MSMarco/relation_train.txt", 
      "input_type": "PairGenerator", 
      "batch_size": 100, 
      "batch_per_iter": 5, 
      "phase": "TRAIN", 
      "query_per_iter": 50, 
      "use_iter": false
    }, 
    "share": {
      "vocab_size": 534432, 
      "use_dpool": true, 
      "embed_size": 300, 
      "target_mode": "ranking", 
      "text1_corpus": "./data/MSMarco/corpus_preprocessed.txt", 
      "text2_corpus": "./data/MSMarco/corpus_preprocessed.txt", 
      "embed_path": "./data/MSMarco/embed_glove_d300_norm", 
      "text1_maxlen": 30, 
      "train_embed": true, 
      "text2_maxlen": 289
    }, 
    "valid": {
      "phase": "EVAL", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_valid.txt", 
      "batch_list": 10
    }
  }, 
  "global": {
    "optimizer": "adadelta", 
    "num_iters": 400, 
    "save_weights_iters": 10, 
    "learning_rate": 1.0, 
    "test_weights_iters": 400, 
    "weights_file": "examples/msmarco/weights/matchpyramid.msmarco.weights", 
    "model_type": "PY", 
    "display_interval": 10
  }, 
  "outputs": {
    "predict": {
      "save_format": "TREC", 
      "save_path": "predict.test.matchpyramid.msmarco_289_30.txt"
    }
  }, 
  "losses": [
    {
      "object_name": "rank_hinge_loss", 
      "object_params": {
        "margin": 1.0
      }
    }
  ], 
  "metrics": [
    "map"
  ], 
  "net_name": "MatchPyramid", 
  "model": {
    "model_py": "matchpyramid.MatchPyramid", 
    "setting": {
      "dpool_size": [
        3, 
        10
      ], 
      "dropout_rate": 0.95, 
      "kernel_count": 64, 
      "kernel_size": [
        3, 
        3
      ]
    }, 
    "model_path": "./matchzoo/models/"
  }
}
[./data/MSMarco/embed_glove_d300_norm]
	Embedding size: 534432
Generate numpy embed: (534432, 300)
[Embedding] Embedding Load Done.
[Input] Process Input Tags. [u'train'] in TRAIN, [u'test', u'valid'] in EVAL.
[./data/MSMarco/corpus_preprocessed.txt]
	Data size: 1813717
[Dataset] 1 Dataset Load Done.
{u'relation_file': u'./data/MSMarco/relation_train.txt', u'vocab_size': 534432, u'query_per_iter': 50, u'use_dpool': True, u'embed_size': 300, u'target_mode': u'ranking', u'input_type': u'PairGenerator', u'text1_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'batch_size': 100, u'batch_per_iter': 5, u'text2_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'embed_path': u'./data/MSMarco/embed_glove_d300_norm', u'text1_maxlen': 30, u'phase': u'TRAIN', 'embed': array([[-0.098537,  0.062197,  0.025166, ..., -0.064694,  0.035411,
         0.052771],
       [-0.075983,  0.109294, -0.072987, ...,  0.035435,  0.089257,
         0.01103 ],
       [-0.083153, -0.053231,  0.091988, ..., -0.074868,  0.028196,
         0.026822],
       ...,
       [ 0.027877,  0.002829, -0.018138, ..., -0.051263, -0.023877,
         0.088617],
       [ 0.033975, -0.018657,  0.029754, ...,  0.086803,  0.022534,
        -0.043095],
       [ 0.      ,  0.      ,  0.      , ...,  0.      ,  0.      ,
         0.      ]], dtype=float32), u'train_embed': True, u'text2_maxlen': 289, u'use_iter': False}
[./data/MSMarco/relation_train.txt]
	Instance size: 2259576
self.batch_size
100
Pair Instance Count: 2343172
[PairGenerator] init done
{u'relation_file': u'./data/MSMarco/relation_test.txt', u'vocab_size': 534432, u'use_dpool': True, u'embed_size': 300, u'target_mode': u'ranking', u'input_type': u'ListGenerator', u'batch_list': 10, u'text1_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'text2_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'embed_path': u'./data/MSMarco/embed_glove_d300_norm', u'text1_maxlen': 30, u'phase': u'EVAL', 'embed': array([[-0.098537,  0.062197,  0.025166, ..., -0.064694,  0.035411,
         0.052771],
       [-0.075983,  0.109294, -0.072987, ...,  0.035435,  0.089257,
         0.01103 ],
       [-0.083153, -0.053231,  0.091988, ..., -0.074868,  0.028196,
         0.026822],
       ...,
       [ 0.027877,  0.002829, -0.018138, ..., -0.051263, -0.023877,
         0.088617],
       [ 0.033975, -0.018657,  0.029754, ...,  0.086803,  0.022534,
        -0.043095],
       [ 0.      ,  0.      ,  0.      , ...,  0.      ,  0.      ,
         0.      ]], dtype=float32), u'train_embed': True, u'text2_maxlen': 289}
[./data/MSMarco/relation_test.txt]
	Instance size: 280652
List Instance Count: 5558
[ListGenerator] init done
{u'relation_file': u'./data/MSMarco/relation_valid.txt', u'vocab_size': 534432, u'use_dpool': True, u'embed_size': 300, u'target_mode': u'ranking', u'input_type': u'ListGenerator', u'batch_list': 10, u'text1_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'text2_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'embed_path': u'./data/MSMarco/embed_glove_d300_norm', u'text1_maxlen': 30, u'phase': u'EVAL', 'embed': array([[-0.098537,  0.062197,  0.025166, ..., -0.064694,  0.035411,
         0.052771],
       [-0.075983,  0.109294, -0.072987, ...,  0.035435,  0.089257,
         0.01103 ],
       [-0.083153, -0.053231,  0.091988, ..., -0.074868,  0.028196,
         0.026822],
       ...,
       [ 0.027877,  0.002829, -0.018138, ..., -0.051263, -0.023877,
         0.088617],
       [ 0.033975, -0.018657,  0.029754, ...,  0.086803,  0.022534,
        -0.043095],
       [ 0.      ,  0.      ,  0.      , ...,  0.      ,  0.      ,
         0.      ]], dtype=float32), u'train_embed': True, u'text2_maxlen': 289}
[./data/MSMarco/relation_valid.txt]
	Instance size: 280660
List Instance Count: 5558
[ListGenerator] init done
[MatchPyramid] init done
[layer]: Input	[shape]: [None, 30] 
40.4% memory has been used
[layer]: Input	[shape]: [None, 289] 
40.4% memory has been used
[layer]: Input	[shape]: [None, 30, 289, 3] 
40.4% memory has been used
[layer]: Embedding	[shape]: [None, 30, 300] 
40.9% memory has been used
[layer]: Embedding	[shape]: [None, 289, 300] 
40.9% memory has been used
[layer]: Dot	[shape]: [None, 30, 289] 
40.9% memory has been used
[layer]: Reshape	[shape]: [None, 30, 289, 1] 
40.9% memory has been used
[layer]: Conv2D	[shape]: [None, 30, 289, 64] 
40.9% memory has been used
[layer]: DynamicMaxPooling	[shape]: [None, 3, 10, 64] 
40.9% memory has been used
[layer]: Flatten	[shape]: [None, None] 
40.9% memory has been used
[layer]: Dropout	[shape]: [None, None] 
40.9% memory has been used
[layer]: Dense	[shape]: [None, 1] 
40.9% memory has been used
[Model] Model Compile Done.
[01-12-2019 15:37:01]	[Train:train] Iter:0	loss=1.045190
[01-12-2019 15:37:44]	[Eval:test] Iter:0	map=0.141813
[01-12-2019 15:46:11]	[Eval:valid] Iter:0	map=0.146910
[01-12-2019 16:19:58]	[Train:train] Iter:1	loss=0.995394
[01-12-2019 16:20:21]	[Eval:test] Iter:1	map=0.184708
[01-12-2019 16:48:27]	[Eval:valid] Iter:1	map=0.189873
[01-12-2019 17:15:06]	[Train:train] Iter:2	loss=1.024951
[01-12-2019 17:15:30]	[Eval:test] Iter:2	map=0.215062
[01-12-2019 17:41:04]	[Eval:valid] Iter:2	map=0.220038
[01-12-2019 18:07:41]	[Train:train] Iter:3	loss=0.980129
[01-12-2019 18:09:05]	[Eval:test] Iter:3	map=0.236310
[01-12-2019 18:37:10]	[Eval:valid] Iter:3	map=0.245423
[01-12-2019 19:04:57]	[Train:train] Iter:4	loss=0.968247
[01-12-2019 19:05:17]	[Eval:test] Iter:4	map=0.254258
[01-12-2019 19:33:29]	[Eval:valid] Iter:4	map=0.263224
[01-12-2019 20:01:33]	[Train:train] Iter:5	loss=0.968635
[01-12-2019 20:01:54]	[Eval:test] Iter:5	map=0.264491
[01-12-2019 20:30:07]	[Eval:valid] Iter:5	map=0.274242
[01-12-2019 20:58:16]	[Train:train] Iter:6	loss=0.942538
[01-12-2019 20:58:37]	[Eval:test] Iter:6	map=0.274097
[01-12-2019 21:27:04]	[Eval:valid] Iter:6	map=0.284317
[01-12-2019 21:57:45]	[Train:train] Iter:7	loss=0.929031
[01-12-2019 21:58:45]	[Eval:test] Iter:7	map=0.281499
[01-12-2019 22:27:41]	[Eval:valid] Iter:7	map=0.292577
[01-12-2019 22:57:10]	[Train:train] Iter:8	loss=0.898518
[01-12-2019 22:57:50]	[Eval:test] Iter:8	map=0.284671
[01-12-2019 23:41:30]	[Eval:valid] Iter:8	map=0.296446
[01-13-2019 00:27:18]	[Train:train] Iter:9	loss=0.887084
[01-13-2019 00:27:38]	[Eval:test] Iter:9	map=0.291009
[01-13-2019 01:00:25]	[Eval:valid] Iter:9	map=0.307510
[01-13-2019 01:34:22]	[Train:train] Iter:10	loss=0.853073
[01-13-2019 01:34:42]	[Eval:test] Iter:10	map=0.299223
[01-13-2019 02:21:33]	[Eval:valid] Iter:10	map=0.314019
[01-13-2019 03:00:47]	[Train:train] Iter:11	loss=0.871646
[01-13-2019 03:01:24]	[Eval:test] Iter:11	map=0.307618
[01-13-2019 03:15:11]	[Eval:valid] Iter:11	map=0.319587
[01-13-2019 03:28:48]	[Train:train] Iter:12	loss=0.847419
[01-13-2019 03:29:08]	[Eval:test] Iter:12	map=0.310066
[01-13-2019 03:45:35]	[Eval:valid] Iter:12	map=0.323902
[01-13-2019 04:26:04]	[Train:train] Iter:13	loss=0.809094
[01-13-2019 04:26:37]	[Eval:test] Iter:13	map=0.313192
[01-13-2019 04:40:12]	[Eval:valid] Iter:13	map=0.327034
[01-13-2019 04:53:42]	[Train:train] Iter:14	loss=0.810544
[01-13-2019 04:54:04]	[Eval:test] Iter:14	map=0.318304
[01-13-2019 05:21:55]	[Eval:valid] Iter:14	map=0.330658
[01-13-2019 05:35:17]	[Train:train] Iter:15	loss=0.803571
[01-13-2019 05:35:38]	[Eval:test] Iter:15	map=0.320416
[01-13-2019 06:02:15]	[Eval:valid] Iter:15	map=0.335578
[01-13-2019 06:32:59]	[Train:train] Iter:16	loss=0.744268
[01-13-2019 06:33:20]	[Eval:test] Iter:16	map=0.325551
[01-13-2019 06:46:56]	[Eval:valid] Iter:16	map=0.340058
[01-13-2019 07:00:45]	[Train:train] Iter:17	loss=0.759826
[01-13-2019 07:01:05]	[Eval:test] Iter:17	map=0.326163
[01-13-2019 07:14:51]	[Eval:valid] Iter:17	map=0.342779
[01-13-2019 07:28:34]	[Train:train] Iter:18	loss=0.787188
[01-13-2019 07:28:54]	[Eval:test] Iter:18	map=0.326619
[01-13-2019 07:42:38]	[Eval:valid] Iter:18	map=0.343477
[01-13-2019 08:01:03]	[Train:train] Iter:19	loss=0.759099
[01-13-2019 08:01:25]	[Eval:test] Iter:19	map=0.329675
[01-13-2019 08:46:07]	[Eval:valid] Iter:19	map=0.347205
[01-13-2019 09:33:12]	[Train:train] Iter:20	loss=0.704193
[01-13-2019 09:33:34]	[Eval:test] Iter:20	map=0.331053
[01-13-2019 10:23:09]	[Eval:valid] Iter:20	map=0.347737
[01-13-2019 10:53:30]	[Train:train] Iter:21	loss=0.700643
[01-13-2019 10:53:50]	[Eval:test] Iter:21	map=0.331804
[01-13-2019 11:07:15]	[Eval:valid] Iter:21	map=0.349847
[01-13-2019 11:20:43]	[Train:train] Iter:22	loss=0.747054
[01-13-2019 11:21:03]	[Eval:test] Iter:22	map=0.334635
[01-13-2019 12:08:56]	[Eval:valid] Iter:22	map=0.352708
[01-13-2019 13:09:18]	[Train:train] Iter:23	loss=0.729910
[01-13-2019 13:09:44]	[Eval:test] Iter:23	map=0.335573
[01-13-2019 14:14:17]	[Eval:valid] Iter:23	map=0.354392
[01-13-2019 14:37:44]	[Train:train] Iter:24	loss=0.696882
[01-13-2019 14:38:04]	[Eval:test] Iter:24	map=0.335603
[01-13-2019 15:06:46]	[Eval:valid] Iter:24	map=0.354919
[01-13-2019 15:27:49]	[Train:train] Iter:25	loss=0.728907
[01-13-2019 15:28:08]	[Eval:test] Iter:25	map=0.337174
[01-13-2019 15:45:01]	[Eval:valid] Iter:25	map=0.355630
[01-13-2019 16:07:15]	[Train:train] Iter:26	loss=0.687136
[01-13-2019 16:07:36]	[Eval:test] Iter:26	map=0.338196
[01-13-2019 16:19:04]	[Eval:valid] Iter:26	map=0.357500
[01-13-2019 16:42:47]	[Train:train] Iter:27	loss=0.689186
[01-13-2019 16:43:07]	[Eval:test] Iter:27	map=0.341595
[01-13-2019 17:09:47]	[Eval:valid] Iter:27	map=0.359232
[01-13-2019 18:01:41]	[Train:train] Iter:28	loss=0.673624
[01-13-2019 18:02:01]	[Eval:test] Iter:28	map=0.340896
[01-13-2019 18:58:42]	[Eval:valid] Iter:28	map=0.359742
[01-13-2019 20:47:38]	[Train:train] Iter:29	loss=0.684388
[01-13-2019 20:48:02]	[Eval:test] Iter:29	map=0.338866
[01-13-2019 21:30:06]	[Eval:valid] Iter:29	map=0.360046
{
  "inputs": {
    "test": {
      "phase": "EVAL", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_test.txt", 
      "batch_list": 10
    }, 
    "predict": {
      "phase": "PREDICT", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_test.txt", 
      "batch_list": 10
    }, 
    "train": {
      "relation_file": "./data/MSMarco/relation_train.txt", 
      "input_type": "PairGenerator", 
      "batch_size": 100, 
      "batch_per_iter": 5, 
      "phase": "TRAIN", 
      "query_per_iter": 50, 
      "use_iter": false
    }, 
    "share": {
      "vocab_size": 534432, 
      "use_dpool": true, 
      "embed_size": 300, 
      "target_mode": "ranking", 
      "text1_corpus": "./data/MSMarco/corpus_preprocessed.txt", 
      "text2_corpus": "./data/MSMarco/corpus_preprocessed.txt", 
      "embed_path": "./data/MSMarco/embed_glove_d300_norm", 
      "text1_maxlen": 30, 
      "train_embed": true, 
      "text2_maxlen": 289
    }, 
    "valid": {
      "phase": "EVAL", 
      "input_type": "ListGenerator", 
      "relation_file": "./data/MSMarco/relation_valid.txt", 
      "batch_list": 10
    }
  }, 
  "global": {
    "optimizer": "adadelta", 
    "num_iters": 400, 
    "save_weights_iters": 10, 
    "learning_rate": 1.0, 
    "test_weights_iters": 400, 
    "weights_file": "examples/msmarco/weights/matchpyramid.msmarco.weights", 
    "model_type": "PY", 
    "display_interval": 10
  }, 
  "outputs": {
    "predict": {
      "save_format": "TREC", 
      "save_path": "predict.test.matchpyramid.msmarco_289_30.txt"
    }
  }, 
  "losses": [
    {
      "object_name": "rank_hinge_loss", 
      "object_params": {
        "margin": 1.0
      }
    }
  ], 
  "metrics": [
    "map"
  ], 
  "net_name": "MatchPyramid", 
  "model": {
    "model_py": "matchpyramid.MatchPyramid", 
    "setting": {
      "dpool_size": [
        3, 
        10
      ], 
      "dropout_rate": 0.95, 
      "kernel_count": 64, 
      "kernel_size": [
        3, 
        3
      ]
    }, 
    "model_path": "./matchzoo/models/"
  }
}
[./data/MSMarco/embed_glove_d300_norm]
	Embedding size: 534432
Generate numpy embed: (534432, 300)
[Embedding] Embedding Load Done.
[Input] Process Input Tags. [u'predict'] in PREDICT.
[./data/MSMarco/corpus_preprocessed.txt]
	Data size: 1813717
[Dataset] 1 Dataset Load Done.
{u'relation_file': u'./data/MSMarco/relation_test.txt', u'vocab_size': 534432, u'use_dpool': True, u'embed_size': 300, u'target_mode': u'ranking', u'input_type': u'ListGenerator', u'batch_list': 10, u'text1_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'text2_corpus': u'./data/MSMarco/corpus_preprocessed.txt', u'embed_path': u'./data/MSMarco/embed_glove_d300_norm', u'text1_maxlen': 30, u'phase': u'PREDICT', 'embed': array([[-0.098537,  0.062197,  0.025166, ..., -0.064694,  0.035411,
         0.052771],
       [-0.075983,  0.109294, -0.072987, ...,  0.035435,  0.089257,
         0.01103 ],
       [-0.083153, -0.053231,  0.091988, ..., -0.074868,  0.028196,
         0.026822],
       ...,
       [ 0.027877,  0.002829, -0.018138, ..., -0.051263, -0.023877,
         0.088617],
       [ 0.033975, -0.018657,  0.029754, ...,  0.086803,  0.022534,
        -0.043095],
       [ 0.      ,  0.      ,  0.      , ...,  0.      ,  0.      ,
         0.      ]], dtype=float32), u'train_embed': True, u'text2_maxlen': 289}
[./data/MSMarco/relation_test.txt]
	Instance size: 280652
List Instance Count: 5558
[ListGenerator] init done
[MatchPyramid] init done
[layer]: Input	[shape]: [None, 30] 
40.1% memory has been used
[layer]: Input	[shape]: [None, 289] 
40.1% memory has been used
[layer]: Input	[shape]: [None, 30, 289, 3] 
40.1% memory has been used
[layer]: Embedding	[shape]: [None, 30, 300] 
40.6% memory has been used
[layer]: Embedding	[shape]: [None, 289, 300] 
40.6% memory has been used
[layer]: Dot	[shape]: [None, 30, 289] 
40.6% memory has been used
[layer]: Reshape	[shape]: [None, 30, 289, 1] 
40.6% memory has been used
[layer]: Conv2D	[shape]: [None, 30, 289, 64] 
40.6% memory has been used
[layer]: DynamicMaxPooling	[shape]: [None, 3, 10, 64] 
40.6% memory has been used
[layer]: Flatten	[shape]: [None, None] 
40.6% memory has been used
[layer]: Dropout	[shape]: [None, None] 
40.6% memory has been used
[layer]: Dense	[shape]: [None, 1] 
40.6% memory has been used
